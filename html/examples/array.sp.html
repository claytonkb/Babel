<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>C:\babel\2014May3\Babel\sp\smoke\array.sp.html</title>
<meta name="Generator" content="Vim/7.3">
<meta name="plugin-version" content="vim7.3_v6">
<meta name="syntax" content="sparse">
<meta name="settings" content="use_css">
<style type="text/css">
<!--
pre { font-family: monospace; color: #000000; background-color: #ffffff; }
body { font-family: monospace; color: #000000; background-color: #ffffff; }
.Constant { color: #ff00ff; }
.Type { color: #2e8b57; font-weight: bold; }
.Numeric { color: #600060; }
.Statement { color: #0000ff; }
.Identifier { color: #008080; }
.Comment { color: #008000; }
-->
</style>
</head>
<body>
<pre>
<span class="Comment">-- array.sp</span>
<span class="Comment">-- See below for test vectors</span>

((<span class="Identifier">my_leaf</span>       [<span class="Statement">val</span> <span class="Numeric">0</span> <span class="Numeric">1</span> <span class="Numeric">2</span> <span class="Numeric">3</span> <span class="Numeric">4</span> <span class="Numeric">5</span> <span class="Numeric">6</span> <span class="Numeric">7</span> <span class="Numeric">8</span> <span class="Numeric">9</span>])

(<span class="Identifier">my_interior</span>    [<span class="Statement">ptr</span> <span class="Numeric">0</span> <span class="Numeric">1</span> <span class="Numeric">2</span> <span class="Numeric">3</span> <span class="Numeric">4</span> <span class="Numeric">5</span> <span class="Numeric">6</span> <span class="Numeric">7</span> <span class="Numeric">8</span> <span class="Numeric">9</span>])

(<span class="Identifier">main</span> {

    <span class="Comment">-- Converting an array to a list</span>
    <span class="Identifier">my_interior</span>
    <span class="Type">ar2ls</span>

    <span class="Comment">-- Array length</span>
    <span class="Identifier">my_interior</span>
    <span class="Type">arlen</span>

    <span class="Comment">-- array-8 length</span>
    <span class="Constant">&quot;Hello, world&quot;</span> <span class="Type">arlen8</span>

    <span class="Comment">-- Cutting/catting an array</span>
    <span class="Identifier">my_leaf</span>
    <span class="Numeric">3</span> <span class="Type">cut</span> <span class="Type">cat</span>

    <span class="Comment">-- leaf-array s-field, isleaf, etc.</span>
    <span class="Identifier">my_leaf</span> <span class="Type">dup</span> <span class="Type">dup</span>
    <span class="Type">sfield</span>
    <span class="Type">isleaf</span>
    <span class="Type">isinte</span>

    <span class="Comment">-- interior-array s-field, isleaf, etc.</span>
    <span class="Identifier">my_interior</span> <span class="Type">dup</span> <span class="Type">dup</span>
    <span class="Type">sfield</span>
    <span class="Type">isleaf</span>
    <span class="Type">isinte</span>

    <span class="Comment">-- Allocating a new leaf-array</span>
    <span class="Numeric">7</span> <span class="Type">newlf</span>

    <span class="Comment">-- Allocating a new interior-array</span>
    <span class="Numeric">7</span> <span class="Type">newin</span>


    <span class="Comment">-- Comparing two leaf-arrays</span>
    <span class="Identifier">a</span> <span class="Identifier">b</span> ==
    <span class="Identifier">b</span> <span class="Identifier">a</span> ==
    <span class="Identifier">a</span> <span class="Identifier">a</span> ==

    <span class="Identifier">dump_stack</span> !})

(<span class="Identifier">dump_stack</span> {
        { <span class="Type">depth</span> }
        { <span class="Type">depth</span> <span class="Type">take</span> <span class="Type">rev</span> { <span class="Type">bbl2str</span> <span class="Type">nl</span> &lt;&lt; } <span class="Type">each</span> }
        { <span class="Constant">&quot;nil\n&quot;</span> &lt;&lt; }
    <span class="Type">ifte</span>})

(<span class="Identifier">a</span> [<span class="Statement">val</span> <span class="Numeric">1</span> <span class="Numeric">3</span> <span class="Numeric">5</span>])
(<span class="Identifier">b</span> [<span class="Statement">val</span> <span class="Numeric">2</span> <span class="Numeric">4</span> <span class="Numeric">6</span>]))

<span class="Comment">-- Test vectors:</span>
<span class="Comment">-- [val 0x0 ]</span>
<span class="Comment">-- [val 0x1 ]</span>
<span class="Comment">-- [val 0xffffffff ]</span>
<span class="Comment">-- [ptr  nil  nil  nil  nil  nil  nil  nil ]</span>
<span class="Comment">-- [val 0x0 0x0 0x0 0x0 0x0 0x0 0x0 ]</span>
<span class="Comment">-- [val 0x0 ]</span>
<span class="Comment">-- [ptr [val 0x0 ] [val 0x1 ] [val 0x2 ] [val 0x3 ] [val 0x4 ] [val 0x5 ] [val 0x6 ] [val 0x7 ] [val 0x8 ] [val 0x9 ] ]</span>
<span class="Comment">-- [ptr [val 0x0 ] [val 0x1 ] [val 0x2 ] [val 0x3 ] [val 0x4 ] [val 0x5 ] [val 0x6 ] [val 0x7 ] [val 0x8 ] [val 0x9 ] ]</span>
<span class="Comment">-- [val 0x0 ]</span>
<span class="Comment">-- [val 0x0 0x1 0x2 0x3 0x4 0x5 0x6 0x7 0x8 0x9 ]</span>
<span class="Comment">-- [val 0x0 0x1 0x2 0x3 0x4 0x5 0x6 0x7 0x8 0x9 ]</span>
<span class="Comment">-- [val 0x0 0x1 0x2 0x3 0x4 0x5 0x6 0x7 0x8 0x9 ]</span>
<span class="Comment">-- [val 0xa ]</span>
<span class="Comment">-- [ptr [val 0x0 ] [ptr [val 0x1 ] [ptr [val 0x2 ] [ptr [val 0x3 ] [ptr [val 0x4 ] [ptr [val 0x5 ] [ptr [val 0x6 ] [ptr [val</span>
<span class="Comment">-- 0x7 ] [ptr [val 0x8 ] [ptr [val 0x9 ]  nil ] ] ] ] ] ] ] ] ] ]</span>

</pre>
</body>
</html>

